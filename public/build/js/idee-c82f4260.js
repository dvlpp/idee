function scrollToBloc(e,t,i){var o=$(".horizontal"),r=parseInt(o.find(".mur").css("border-left-width"));e.prevAll(".bloc").each(function(){r+=largeurBlocFerme});var s=$(window).width();o.animate({scrollLeft:r-(s-largeurBlocOuvert)/2},t,i)}function isSmartphone(){return $("#XS:visible").length}!function(e){e.fn.bloc=function(){return this.each(function(){e(this).click(function(t){return isSmartphone()?!0:e(t.target).hasClass("imagelightbox")?!0:e(this).hasClass("ouvert")||e(this).hasClass("ouverture")?!1:(e(".projet.ouvert").each(function(){e(this).css("background-image","url("+e(this).data("visuelferme")+")")}),e(this).hasClass("projet")&&e(this).css("background-image","url("+e(this).data("visuelouvert")+")"),e(".bloc.ouvert").each(function(){e(this).addClass("fermeture")}),e(this).addClass("ouverture"),void scrollToBloc(e(this),800))}),e(this).find(".action-pli").click(function(t){if(isSmartphone())return!1;var i=e(this).parent(".bloc"),o=i.parents(".horizontal");i.hasClass("deplie")?(i.removeClass("deplie"),o.removeClass("verouille"),i.hasClass("page")&&i.addClass("fermeture")):(i.find(".fiche").hide(),i.addClass("deplie"),i.find(".fiche").fadeIn(),scrollToBloc(i,0),o.addClass("verouille"),window.history.pushState({foo:"bar"},e(t.currentTarget).data("titre"),e(t.currentTarget).prop("href")))}),e(this).on("transitionend MSTransitionEnd webkitTransitionEnd oTransitionEnd",function(){if(isSmartphone())return!1;if(e(this).hasClass("ouverture"))e(this).removeClass("ouverture"),e(this).addClass("ouvert"),e(this).hasClass("page")&&e(this).find(".action-pli").click();else if(e(this).hasClass("fermeture")){var t=e(this).parents(".horizontal");t.removeClass("verouille"),e(this).removeClass("fermeture ouvert ouverture deplie")}})})}}(jQuery);var largeurBlocFerme=parseInt($(".bloc:not(.ouvert):not(.ouverture)").css("width")),largeurBlocOuvert=parseInt($(".bloc.projet.ouvert").css("width"));$(document).ready(function(){function e(){var e=$(".bloc.ouvert"),t=e.prev(".bloc");i(e,t)}function t(){var e=$(".bloc.ouvert"),t=e.next(".bloc");i(e,t)}function i(e,t){t.length&&(e.hasClass("deplie")&&e.find(".action-pli").click(),t.click())}function o(){isSmartphone()?($("#swiper-css").attr("href","/css/swiper.css"),$(".mur").css("width",$(window).width()),$(".mur .bloc.projet").each(function(){$(this).css("background-image","url("+$(this).data("visuelouvert")+")")}),n=new Swiper(".horizontal",{onInit:function(e){e.slideTo($(".bloc.ouvert").index())}})):n&&(n.destroy(),n=void 0,$(".mur").removeProp("style"),$(".mur .bloc").css("width",""),$(".mur .bloc.projet").each(function(){$(this).css("background-image","url("+$(this).data("visuelferme")+")")}),$("#swiper-css").attr("href","/css/empty.css"))}var r=!1;$(".bloc").bloc(),scrollToBloc($(".bloc.ouvert"),0),$(document).keyup(function(i){if(!r)if(27==i.keyCode||38==i.keyCode)$(".bloc.ouvert.deplie .action-pli").click();else if(37==i.keyCode)e();else if(39==i.keyCode)t();else if(40==i.keyCode||13==i.keyCode){var o=$(".bloc.ouvert");o.hasClass("deplie")||o.find(".action-pli").click()}}),$("header .left").click(function(){e()}),$("header .right").click(function(){t()});var s=$(".imagelightbox").imageLightbox({allowedTypes:"",onStart:function(){r=!0},onEnd:function(){r=!1}});$(".horizontal").click(function(){r&&s.quitImageLightbox()});var n;o(),$(window).resize(function(){o()})});
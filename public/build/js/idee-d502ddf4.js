function scrollToBloc(e,i,t){var s=$(".horizontal"),o=parseInt(s.find(".mur").css("border-left-width"));e.prevAll(".bloc").each(function(){o+=$(this).outerWidth()});var r=e.outerWidth(),n=$(window).width();s.animate({scrollLeft:o-(n-r)/2},i,t)}function isSmartphone(){return $("#XS:visible").length}!function(e){e.fn.bloc=function(){return this.each(function(){e(this).click(function(i){return isSmartphone()?!0:e(i.target).hasClass("imagelightbox")?!0:e(this).hasClass("ouvert")||e(this).hasClass("ouverture")?!1:(e(this).hasClass("projet")&&e(this).css("background-image","url("+e(this).data("visuelouvert")+")"),e(".bloc.ouvert").each(function(){e(this).addClass("fermeture")}),void e(this).addClass("ouverture"))}),e(this).find(".action-pli").click(function(i){if(isSmartphone())return!1;var t=e(this).parent(".bloc"),s=t.parents(".horizontal");t.hasClass("deplie")?(t.removeClass("deplie"),s.removeClass("verouille"),t.hasClass("page")&&t.addClass("fermeture")):(t.find(".fiche").hide(),t.addClass("deplie"),t.find(".fiche").fadeIn(),scrollToBloc(t,0),s.addClass("verouille"),window.history.pushState({foo:"bar"},e(i.currentTarget).data("titre"),e(i.currentTarget).prop("href")))}),e(this).on("transitionend MSTransitionEnd webkitTransitionEnd oTransitionEnd",function(){if(isSmartphone())return!1;if(e(this).hasClass("ouverture"))e(this).removeClass("ouverture"),e(this).addClass("ouvert"),e(this).hasClass("page")&&e(this).find(".action-pli").click(),scrollToBloc(e(this),800);else if(e(this).hasClass("fermeture")){var i=e(this).parents(".horizontal");i.removeClass("verouille"),e(this).removeClass("fermeture ouvert ouverture deplie"),e(this).hasClass("projet")&&e(this).css("background-image","url("+e(this).data("visuelferme")+")")}})})}}(jQuery),$(document).ready(function(){function e(){var e=$(".bloc.ouvert"),i=e.prev(".bloc");t(e,i)}function i(){var e=$(".bloc.ouvert"),i=e.next(".bloc");t(e,i)}function t(e,i){i.length&&(e.hasClass("deplie")&&e.find(".action-pli").click(),i.click())}function s(){isSmartphone()?($("#swiper-css").attr("href","/css/swiper.css"),$(".mur").css("width",$(window).width()),$(".mur .bloc.projet").each(function(){$(this).css("background-image","url("+$(this).data("visuelouvert")+")")}),n=new Swiper(".horizontal",{onInit:function(e){e.slideTo($(".bloc.ouvert").index())}})):n&&(n.destroy(),n=void 0,$(".mur").removeProp("style"),$(".mur .bloc").css("width",""),$(".mur .bloc.projet").each(function(){$(this).css("background-image","url("+$(this).data("visuelferme")+")")}),$("#swiper-css").attr("href","/css/empty.css"))}var o=!1;$(".bloc").bloc(),scrollToBloc($(".bloc.ouvert"),0),$(document).keyup(function(t){if(!o)if(27==t.keyCode||38==t.keyCode)$(".bloc.ouvert.deplie .action-pli").click();else if(37==t.keyCode)e();else if(39==t.keyCode)i();else if(40==t.keyCode||13==t.keyCode){var s=$(".bloc.ouvert");s.hasClass("deplie")||s.find(".action-pli").click()}}),$("header .left").click(function(){e()}),$("header .right").click(function(){i()});var r=$(".imagelightbox").imageLightbox({allowedTypes:"",onStart:function(){o=!0},onEnd:function(){o=!1}});$(".horizontal").click(function(){o&&r.quitImageLightbox()});var n;s(),$(window).resize(function(){s()})});
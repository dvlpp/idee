function scrollToBloc(e,t,o){var i=$(".horizontal"),r=parseInt(i.find(".mur").css("border-left-width"));e.prevAll(".bloc").each(function(){r+=largeurBlocFerme});var s=$(window).width();i.animate({scrollLeft:r-(s-largeurBlocOuvert)/2},t,o)}function isSmartphone(){return $("#XS:visible").length}var largeurBlocFerme=parseInt($(".bloc:not(.ouvert):not(.ouverture)").css("width")),largeurBlocOuvert=parseInt($(".bloc.ouvert").css("width")),couleurBlocFerme=$(".bloc:not(.ouvert):not(.ouverture)").css("background-color");!function(e){e.fn.bloc=function(){return this.each(function(){e(this).click(function(t){return isSmartphone()?!0:e(t.target).parents(".fiche").length?!0:e(this).hasClass("ouvert")||e(this).hasClass("ouverture")?!1:(e(".projet.ouvert").each(function(){e(this).data("visuelferme")&&e(this).css("background-image","url("+e(this).data("visuelferme")+")"),e(this).css("background-color",couleurBlocFerme)}),e(this).hasClass("projet")&&(e(this).data("visuelouvert")&&e(this).css("background-image","url("+e(this).data("visuelouvert")+")"),e(this).css("background-color",e(this).data("couleur"))),e(".bloc.ouvert").each(function(){e(this).addClass("fermeture")}),e(this).addClass("ouverture"),void scrollToBloc(e(this),800))}),e(this).find(".action-pli").click(function(t){if(isSmartphone())return!1;var o=e(this).parent(".bloc"),i=o.parents(".horizontal");e(this).addClass("hidden"),o.hasClass("deplie")?(o.removeClass("deplie"),i.removeClass("verouille"),o.hasClass("page")&&o.addClass("fermeture")):(o.find(".fiche").hide(),o.addClass("deplie"),o.find(".fiche").fadeIn(),scrollToBloc(o,0),i.addClass("verouille"),window.history.pushState({foo:"bar"},e(t.currentTarget).data("titre"),e(t.currentTarget).prop("href"))),e(this).removeClass("hidden")}),e(this).on("transitionend MSTransitionEnd webkitTransitionEnd oTransitionEnd",function(){if(isSmartphone())return!1;if(e(this).hasClass("ouverture"))e(this).removeClass("ouverture"),e(this).addClass("ouvert"),e(this).hasClass("page")&&e(this).find(".action-pli").click();else if(e(this).hasClass("fermeture")){var t=e(this).parents(".horizontal");t.removeClass("verouille"),e(this).removeClass("fermeture ouvert ouverture deplie")}})})}}(jQuery),$(document).ready(function(){function e(){var e=$('a[href="'+$("#imagelightbox").attr("src")+'"]').attr("title");e.length>0&&$('<div id="imagelightbox-caption">'+e+"</div>").appendTo("body")}function t(){$("#imagelightbox-caption").remove()}function o(){var e=$(".bloc.ouvert"),t=e.prev(".bloc");r(e,t)}function i(){var e=$(".bloc.ouvert"),t=e.next(".bloc");r(e,t)}function r(e,t){t.length&&(e.hasClass("deplie")&&e.find(".action-pli").click(),t.click())}function s(e){for(var t=e;t==e;)t=25*Math.floor(6*Math.random());var o="-"+t+"px";c.css("background-position","center "+o),window.setTimeout(function(){s(t)},3e3)}function n(){isSmartphone()?($("#swiper-css").attr("href","/css/swiper.css"),$(".mur .bloc.projet").each(function(){$(this).css("background-image","url("+$(this).data("visuelouvert")+")")}),u=new Swiper(".horizontal",{spaceBetween:0,initialSlide:$(".bloc.ouvert").index(),threshold:20})):u&&(u.destroy(),u=void 0,$(".mur").removeProp("style"),$(".mur .bloc").css("width",""),$(".mur .bloc.projet").each(function(){$(this).css("background-image","url("+$(this).data("visuelferme")+")")}),$("#swiper-css").attr("href","/css/empty.css"))}var a=!1;$(".bloc").bloc(),scrollToBloc($(".bloc.ouvert"),0),$(document).keyup(function(e){if(!a)if(27==e.keyCode||38==e.keyCode)$(".bloc.ouvert.deplie .action-pli").click();else if(37==e.keyCode)o();else if(39==e.keyCode)i();else if(40==e.keyCode||13==e.keyCode){var t=$(".bloc.ouvert");t.hasClass("deplie")||t.find(".action-pli").click()}}),$("header .left").click(function(){o()}),$("header .right").click(function(){i()});var l=$(".imagelightbox").imageLightbox({allowedTypes:"",onLoadStart:function(){t()},onLoadEnd:function(){e()},onStart:function(){a=!0},onEnd:function(){t(),a=!1}});$(".horizontal").click(function(){a&&l.quitImageLightbox()});var c=$("header .logo .marque");window.setTimeout(function(){s(0)},3e3);var u;n(),isSmartphone()&&u.slideTo($(".bloc.ouvert").index()),$(window).resize(function(){n()})});